<!DOCTYPE html>
<html lang="en">

<%- include('../common/header'); %>

   <body class="sidebar-mini fixed">
      <div class="loader-bg">
         <div class="loader-bar">
         </div>
      </div>
      <div class="wrapper">
         <!-- Navbar-->
         <%- include('../common/nav'); %>
            <!-- Side-Nav-->
            <%- include('../common/side_nav'); %>

               <div class="content-wrapper">
                  <!-- Container-fluid starts -->
                  <!-- Main content starts -->
                  <div class="container-fluid">
                     <div class="row">
                        <div class="main-header">
                           <h4>Dashboard</h4>
                        </div>
                     </div>
                     <!-- 4-blocks row start -->
                     <div class="row dashboard-header">

                        <div class="col-lg-3 col-md-6">
                           <div class="card dashboard-product">
                              <span>In Stock</span>
                              <h2 class="dashboard-total-products" id="inStock">
                                 <%= inStock %>
                              </h2>
                              <!-- <span class="label label-warning">Sales</span>Arriving Today -->
                              <div class="side-box">
                                 <i class="ti-dropbox-alt text-warning-color"></i>
                              </div>
                           </div>
                        </div>

                        <div class="col-lg-3 col-md-6">
                           <div class="card dashboard-product">
                              <span>Low Stock</span>
                              <h2 class="dashboard-total-products" id="lowStock">
                                 <%= lowStock %>
                              </h2>
                              <!-- <span class="label label-primary">Views</span>View Today -->
                              <div class="side-box ">
                                 <i class="ti-stats-down text-primary-color"></i>
                              </div>
                           </div>
                        </div>

                        <div class="col-lg-3 col-md-6">
                           <div class="card dashboard-product">
                              <span>Out Of Stock</span>
                              <h2 class="dashboard-total-products" id="outOfStock">
                                 <%= outOfStock %>
                              </h2>
                              <!-- <span class="label label-success">Sales</span>Reviews -->
                              <div class="side-box">
                                 <i class="ti-alert text-success-color"></i>
                              </div>
                           </div>
                        </div>

                        <div class="col-lg-3 col-md-6">
                           <div class="card dashboard-product">
                              <span>Expired</span>
                              <h2 class="dashboard-total-products" id="expired">
                                 <%= expired %>
                              </h2>
                              <!-- <span class="label label-danger">Sales</span>Reviews -->
                              <div class="side-box">
                                 <i class="ti-calendar text-danger-color"></i>
                              </div>
                           </div>
                        </div>

                     </div>
                     <!-- 4-blocks row end -->

                     <!-- 1-3-block row start -->
                     <div class="row">
                        <div class="col-lg-8">
                           <div class="card">
                              <div class="card-header">
                                 <h5 class="card-header-text">Bar chart</h5>
                              </div>
                              <div class="card-block">
                                 <div id="barchart" style="min-width: 250px; height: 330px; margin: 0 auto"></div>
                              </div>
                           </div>
                        </div>
                        <div class="col-xl-4 col-lg-12 grid-item">
                           <div class="card dashboard-product">
                              <span>Total Sales Today</span>
                              <h2 class="dashboard-total-products">
                                 <%= totalSales %>
                              </h2>
                              <!-- <span class="label label-danger">Sales</span>Reviews -->
                              <div class="side-box">
                                 <i class="ti-tag text-danger-color"></i>
                              </div>
                           </div>
                        </div>

                        <div class="col-xl-4 col-lg-12 grid-item">
                           <div class="card dashboard-product">
                              <span>Products Sold Today</span>
                              <h2 class="dashboard-total-products">
                                 <%= itemsSold %>
                              </h2>
                              <!-- <span class="label label-danger">Sales</span>Reviews -->
                              <div class="side-box">
                                 <i class="ti-tag text-danger-color"></i>
                              </div>
                           </div>
                        </div>

                        <div class="col-xl-4 col-lg-12 grid-item">
                           <div class="card dashboard-product">
                              <span>Total Sales This Month</span>
                              <h2 class="dashboard-total-products">
                                 <%= monthlySales %>
                              </h2>
                              <!-- <span class="label label-danger">Sales</span>Reviews -->
                              <div class="side-box">
                                 <i class="ti-tag text-danger-color"></i>
                              </div>
                           </div>
                        </div>

                     </div>
                     <!-- 1-3-block row end -->

                     <!-- 2-1 block start -->
                     <div class="row">
                        <div class="col-xl-8 col-lg-12">
                           <div class="card">
                              <div class="card-block">
                                 <div class="table-responsive">
                                    <table class="table m-b-0 photo-table">
                                       <thead>
                                          <tr class="text-uppercase">
                                             <th>Photo</th>
                                             <th>Name</th>
                                             <th>Email</th>
                                             <th>Status</th>
                                             <th>Water</th>
                                          </tr>
                                       </thead>
                                       <tbody>
                                          <tr>
                                             <th>
                                                <img class="img-fluid img-circle" src="assets/images/kiet.jpg"
                                                   alt="User">
                                             </th>
                                             <td>Nguyễn Tuấn Kiệt
                                                <p><i class="icofont icofont-user"></i>Housekeeper</p>
                                             </td>
                                             <td>kietntde11111@fpt.edu.vn
                                                <p><i class="icofont icofont-clock-time"></i>.</p>
                                             </td>
                                             <td>Tẻng Tẻng</td>
                                             <td>
                                                <span class="pie" style="display: none;">226,134</span><svg
                                                   class="peity" height="30" width="30">
                                                   <path
                                                      d="M 15.000000000000002 0 A 15 15 0 1 1 4.209902994920235 25.41987555688496 L 15 15"
                                                      fill="#2196F3"></path>
                                                   <path
                                                      d="M 4.209902994920235 25.41987555688496 A 15 15 0 0 1 14.999999999999996 0 L 15 15"
                                                      fill="#ccc"></path>
                                                </svg>
                                             </td>
                                          </tr>

                                          <tr>
                                             <th>
                                                <img class="img-circle" style="height: 50px;" src="assets/images/MatMoc.jpg"
                                                   alt="User">
                                             </th>
                                             <td>Nguyễn Đức Trí
                                                <p><i class="icofont icofont-user"></i>Chairman</p>
                                             </td>
                                             <td>trindde170428@fpt.edu.vn
                                                <p><i class="icofont icofont-clock-time"></i>.</p>
                                             </td>
                                             <td>Đẹp Trai</td>
                                             <td>
                                                <span class="pie" style="display: none;">226,134</span><svg
                                                   class="peity" height="30" width="30">
                                                   <path
                                                      d="M 15.000000000000002 0 A 15 15 0 0 1 28.00043211809656 22.482564048691025 L 15 15"
                                                      fill="#2196F3"></path>
                                                   <path
                                                      d="M 28.00043211809656 22.482564048691025 A 15 15 0 1 1 14.999999999999996 0 L 15 15"
                                                      fill="#ccc"></path>
                                                </svg>
                                             </td>
                                          </tr>

                                          <tr>
                                             <th>
                                                <img class="img-fluid img-circle" src="assets/images/tuan.jpg"
                                                   alt="User">
                                             </th>
                                             <td>Tôn Thất Anh Tuấn
                                                <p><i class="icofont icofont-user"></i>Bartender</p>
                                             </td>
                                             <td>tuanttade11111@fpt.edu.vn
                                                <p><i class="icofont icofont-clock-time"></i>.</p>
                                             </td>
                                             <td>Hẹn Hò</td>
                                             <td>
                                                <span class="pie" style="display: none;">226,134</span><svg
                                                   class="peity" height="30" width="30">
                                                   <circle cx="15" cy="15" r="15" fill="#2196F3"></circle>
                                                </svg>
                                             </td>
                                          </tr>

                                          <tr>
                                             <th>
                                                <img class="img-circle" style="height: 50px;" src="assets/images/duy.jpg"
                                                   alt="User">
                                             </th>
                                             <td>Lê Viết Duy
                                                <p><i class="icofont icofont-user"></i>Security guard</p>
                                             </td>
                                             <td>duynguvlde11111@fpt.edu.vn
                                                <p><i class="icofont icofont-clock-time"></i>.</p>
                                             </td>
                                             <td>Trẻ Trâu</td>
                                             <td>
                                                <span class="pie" style="display: none;">226,134</span><svg
                                                   class="peity" height="30" width="30">
                                                   <path d="M 15 0 A 15 15 0 1 1 0 15 L 15 15 Z" fill="#2196F3"></path>
                                                   <path d="M 0 15 A 15 15 0 0 1 15 0 L 15 15" fill="#ccc"></path>
                                                </svg>
                                             </td>
                                          </tr>

                                       </tbody>
                                    </table>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="col-xl-4 col-lg-12" style="margin-top: -58px;">
                           <div class="card">
                              <div class="card-header">
                                 <h5 class="card-header-text">Bar chart</h5>
                              </div>
                              <div class="card-block">
                                 <canvas id="myChart" style="width:100%;max-width:600px"></canvas>
                              </div>
                           </div>
                        </div>
                     </div>
                     <!-- 2-1 block end -->
                  </div>
                  <!-- Main content ends -->
                  <!-- Container-fluid ends -->
                  <div class="fixed-button">
                     <a href="#!" class="btn btn-md btn-primary">
                        <i class="fa fa-shopping-cart" aria-hidden="true"></i> Upgrade To Pro
                     </a>
                  </div>
               </div>
      </div>

      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
      <script src="https://code.highcharts.com/highcharts.js"></script>

      <script>
         var inStock = parseInt(document.getElementById('inStock').textContent, 10);
         var lowStock = parseInt(document.getElementById('lowStock').textContent, 10);
         var outOfStock = parseInt(document.getElementById('outOfStock').textContent, 10);
         var expired = parseInt(document.getElementById('expired').textContent, 10);
         
         var xValues = ["Low Stock", "In Stock", "Out Of Stock", "Expired"];
         var yValues = [lowStock, inStock, outOfStock, expired];
         var barColors = [
            "#b91d47",
            "#00aba9",
            "#2b5797",
            "#e8c3b9",
         ];

         new Chart("myChart", {
            type: "pie",
            data: {
               labels: xValues,
               datasets: [{
                  backgroundColor: barColors,
                  data: yValues
               }]
            },
            options: {
               title: {
                  display: true,
                  text: "World Wide Wine Production 2018"
               }
            }
         });

         // Initialize chart
         const salesData = JSON.parse('<%- JSON.stringify(salesData) %>');
            // Prepare the data for Highcharts

            const salesCategories = Object.keys(salesData).map(date => {
                const d = new Date(date);
                return d.toLocaleDateString('en-GB', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric' // Adjust as needed
                });
            });

            const salesValues = Object.values(salesData);

            // Create the Highcharts chart
            Highcharts.chart('barchart', {
                title: {
                    text: 'Sales Data Over Time' // Title for the chart
                },
                xAxis: {
                    categories: salesCategories,
                    title: {
                        text: 'Date' // Title for x-axis
                    }
                },
                yAxis: {
                    title: {
                        text: 'Total Sales' // Title for y-axis
                    },
                    min: 0 // Start the y-axis at 0
                },
                series: [{
                    type: 'column', // Column chart type
                    name: 'Sales',
                    data: salesValues,
                    color: '#f57c00',
                    pointWidth: 20 // Color for the sales bars
                }, {
                    type: 'spline', // Spline chart for the average
                    name: 'Average',
                    data: salesValues.map(value => value / 10), // Adjust this calculation as needed for your average
                    marker: {
                        lineWidth: 2,
                        lineColor: Highcharts.getOptions().colors[3],
                        fillColor: 'white'
                    }
                }]
            });
      </script>

      <%- include('../common/script'); %>
   </body>

</html>